
<script>
    $(function() {
        $("#service-create").hide();
    });
    
    $("form input:radio").change(function () {
        if($('input:radio("name==radio_choice"):checked').val() == "Basic"){
            $("#service-create").hide();
            $("#basic-create").show();
        }
        else if($('input:radio("name==radio_choice"):checked').val() == "Services") {
            $("#service-create").show();
            $("#basic-create").hide();
        }
    });
    
    function submitFunction() {
        //alert("Call to the submit function ");
        // If mode is basic, validate and put together the JSON and send to backend
        var num_insts = $("#num-insts").val;
        var error_spin = "<p id=\"errspin\" ><font color=\"red\">Error: Please set number of VMs between 1 and 5</font></p>";
        var request = "{\"serverslist\":[{\"servername\":\"myserver1\",\"imageName\":\"9be0b7bb-aca2-41f1-984d-566ae9385cb0\",\"flavour\":\"1\"}";
        var serverInstance = "{\"servername\":\"myserver2\",\"imageName\":\"9be0b7bb-aca2-41f1-984d-566ae9385cb0\",\"flavour\":\"1\"}";
        for(var i=0;i<num_insts.length; i++){
        	request +=","+serverInstance;
        }
        request +="]}";
       //{\"servername\":\"myserver2\",\"imageName\":\"9be0b7bb-aca2-41f1-984d-566ae9385cb0\",\"flavour\":\"1\"}]}"
     $.post(
            "rest/openstack/createServers",
            request,
            function (data, status) {
                console("Data from the server is "+data);
                console("Status returned was "+status);
            });
        
        if($('input:radio("name==radio_choice"):checked').val() == "Basic"){
            //alert("Spin value "+"#num-insts".readonly);
            if ($("#num-insts").val() < 1 || $("#num-insts").val() > 5) {
                //alert("Found illegal number of inst!");
                if ($("#errspin").length > 0) {
                    //do nothing, error msg is already ther
                } else {
                    $("#basic-create").append($(error_spin));        
                }
            }
        } // if mode is service, validate prefix and send the service type to the createService function
        else if($('input:radio("name==radio_choice"):checked').val() == "Services") {
        }
        
    }
    
    function resetFunction() {
        // For some reason, if the radio was set to Service, the form wasn't triggering
        // the change event of the radio.  So I'm manually saying that if
        // reset is called and the form was set to service.  Set it back to Basic
        //var value = $('input:radio(\"name==radio_choice\"):checked').val();
        //alert("Called Reset Function "+value);
        if($('input:radio("name==radio_choice"):checked').val() == "Basic"){
            $("#service-create").hide();
            $("#basic-create").show();
        }
        else if($('input:radio("name==radio_choice"):checked').val() == "Services") {
            $("#service-create").hide();
            $("#basic-create").show();
        }
        
        // if validation error is still there, remove it
        if ($("#errspin").length > 0) {
            $("#errspin").remove();
        }
    }
    
    function createService(service) {
        alert("Call to createService function");
        
    }

    $("#serve-type").change(function() {
        //console.log("Hello, changing selector "+$("#serve-spin").val());
        //alert("Changed value of Select Element! Value of spinner is "+$("#serve-spin".value));
        if ($("#serve-type option:selected").val() =="SmallApplication") {
            $("#serve-spin").val(1) ;
        }
        else if ($("#serve-type option:selected").val() =="WebSite") {
            $("#serve-spin").val(2) ;
        }
        else if ($("#serve-type option:selected").val() =="LargeWebSite") {
            $("#serve-spin").val(3) ;
        }
        else if ($("#serve-type option:selected").val() == "EnterpriseCloud") {
            $("#serve-spin").val(5) ;
        }
        
});
    
</script>

<div data-role="content" class="ui-content left">
    <div id="create-title">
        <h1 id="cr-title">Create New VMs and Services</h1>
    </div>
    
    <div class="create-insts" id="create-insts" data-role="fieldcontain">
        <form id="ci-form" method="post">
            <div id="choose-mode" data-role="fieldcontain">                
                <div data-role="fieldcontain" >
                    <legend>Create Mode:</legend>
                    <label for="radio-choice-1">
                    <input type="radio" name="radio-choice" id="radio-choice-1" value="Basic" checked="checked" />Basic</label>
                    <label for="radio-choice-2">
                    <input type="radio" name="radio-choice" id="radio-choice-2" value="Services" />Services</label>
                </div>
            
                <div id="basic-create" data-role="fieldcontain">
        
                    <label for="vm-name">Instance Name:
                    <input type="text" name="vm-name" id="vm-name" value="" />
                    </label>
        
                    <label for="vm-flavor" class="select">Select Flavor:
                    <select name="vm-flavor" id="vm-flavor">
                        <option value="tiny">Tiny</option>
                        <option value="small">Small</option>
                        <option value="medium">Medium</option>
                        <option value="large">Large</option>
                    </select>
                    </label>
        
                    <label for="vm-image" class="select">Select Image:
                    <select name="vm-image" id="vm-image">
                        <option value="Ubuntu">Ubuntu</option>
                        <option value="Fedora">Fedora</option>
                        <option value="Oracle">Oracle</option>
                    </select>
                    </label>
                        
                    <label>Number of Insts:
                    <input type="text" id="num-insts" placeholder="Number 1-5" />
                    </label>
                        
                </div>
                
                <div id="service-create" data-role="fieldcontain" class="ui-hidden">
                    <label for="serve-name">Instance Prefix:</label>
                    <input type="text" name="serve-name" id="serve-name" value="" />
                
                    <label for="serve-type" class="select">Select a Service:</label>
                    <select name="serve-type" id="serve-type">
                        <option value="SmallApp">Small Application</option>
                        <option value="WebSite">Web Site</option>
                        <option value="LargeWebSite">Large Web Site</option>
                        <option value="EnterpriseCloud">Enterprise Cloud</option>
                    </select>
                        
                    <label for="serve-spin">Number of VMs Created:</label>
                    <input id="serve-spin" type="number" min="0" max="5" value="1" name="serve-spin" readonly>
                        
                    <label for="serve-scale">Auto-Scale:</label>
                    <input type="checkbox" name="serve-scale" id="serve-scale" value="" />
                </div>
                    
                <div id="create-buttons" data-role="fieldcontain" class="ui-grid-a ui-responsive my-breakpoint">
                    <div class="ui-block-a">
                        <input type="submit" data-role="button"  id="create-submit" onclick="submitFunction();return false;" value="Submit" />
                        <input type="reset" data-role="button" id="create-reset" value="Reset" onclick="resetFunction()" \>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
